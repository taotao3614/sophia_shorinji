<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è³‡æ–™å‚ç…§ - ä¸Šæ™ºå¤§å­¦å°‘æ—å¯ºæ‹³æ³•éƒ¨</title>
  <link rel="stylesheet" href="./css/style.css">
  <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <div class="header">
    <h1>è³‡æ–™å‚ç…§</h1>
    <p>æŠ€è¡“å‹•ç”»ã‚„æ´»å‹•è³‡æ–™ã‚’é–²è¦§ã§ãã¾ã™</p>
  </div>

  <div class="container">
    <div class="category-tabs" id="category-tabs">
      <!-- ã‚«ãƒ†ã‚´ãƒªã‚¿ãƒ–ã¯JSã§å‹•çš„ç”Ÿæˆ -->
    </div>

    <div id="materials-list">
      <!-- è³‡æ–™ãƒªã‚¹ãƒˆã¯JSã§å‹•çš„ç”Ÿæˆ -->
    </div>
  </div>

  <div class="footer">
    <p>&copy; 2025 ä¸Šæ™ºå¤§å­¦å°‘æ—å¯ºæ‹³æ³•éƒ¨</p>
  </div>

  <script src="./js/common.js"></script>
  <script>
    let currentCategory = 'technique';

    async function initPage() {
      showLoading();
      try {
        await initializeLiff();
        const config = getConfig();

        if (config && config.materials) {
          renderCategories(config.materials.categories);
          renderMaterials(config.materials.categories[0]);
        }

      } catch (error) {
        console.error('åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
        showAlert('ãƒšãƒ¼ã‚¸ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
      } finally {
        hideLoading();
      }
    }

    function renderCategories(categories) {
      const tabsContainer = document.getElementById('category-tabs');
      tabsContainer.innerHTML = categories.map((cat, index) => `
        <button class="category-tab ${index === 0 ? 'active' : ''}"
                data-category="${cat.id}">
          ${cat.icon} ${cat.name}
        </button>
      `).join('');

      // ã‚¿ãƒ–ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
      document.querySelectorAll('.category-tab').forEach(tab => {
        tab.addEventListener('click', (e) => {
          document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
          e.target.classList.add('active');
          const categoryId = e.target.dataset.category;
          const category = categories.find(c => c.id === categoryId);
          renderMaterials(category);
        });
      });
    }

    function renderMaterials(category) {
      const listContainer = document.getElementById('materials-list');
      if (!category || !category.items || category.items.length === 0) {
        listContainer.innerHTML = '<p class="card-description">ã“ã® ã‚«ãƒ†ã‚´ãƒªã«ã¯è³‡æ–™ãŒã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }

      listContainer.innerHTML = category.items.map(item => `
        <div class="material-item" data-url="${item.url}">
          <div class="material-icon">${getIconForType(item.type)}</div>
          <div class="material-content">
            <div class="material-title">${item.title}</div>
            <div class="material-description">${item.description}</div>
          </div>
        </div>
      `).join('');

      // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
      document.querySelectorAll('.material-item').forEach(item => {
        item.addEventListener('click', () => {
          const url = item.dataset.url;
          openExternalUrl(url);
        });
      });
    }

    function getIconForType(type) {
      const icons = {
        'youtube': 'ğŸ“¹',
        'gdrive': 'ğŸ“',
        'social': 'ğŸ“±',
        'link': 'ğŸ”—'
      };
      return icons[type] || 'ğŸ“„';
    }

    window.addEventListener('load', initPage);
  </script>
</body>
</html>
